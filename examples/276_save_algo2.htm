Version:0.9
StartHTML:0000000105
EndHTML:0000027877
StartFragment:0000001037
EndFragment:0000027861
<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>mXScriptasHTML</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<meta name="generator" content="SynEdit HTML exporter" />
<style type="text/css">
<!--
body { color: #000000; background-color: #FFFFFF; }
.pas1-assembler { }
.pas1-character { text-decoration: underline; }
.pas1-comment { color: #000080; font-style: italic; }
.pas1-float { color: #800080; }
.pas1-hexadecimal { color: #FF00FF; }
.pas1-identifier { }
.pas1-number { color: #FF0000; }
.pas1-preprocessor { font-style: italic; }
.pas1-reservedword { color: #000000; font-weight: bold; }
.pas1-space { }
.pas1-string { color: #008080; }
.pas1-symbol { color: #000000; }
-->
</style>
</head>
<body>
<!--StartFragment--><pre><code><span class="pas1-comment">{***************************************************************
2 /*
3 * System: maXbox :Product: Algorithm
4 * File: $RCS:276_save_algo.txt$:locs=150 
5 * Purpose: Implements a save function in 3 algos
6 *
7 * Release 1.0.2
8 * &copy;:public; Company: kleiner kommunikation
9 * Author: Max
10 * Filepath: $E:\maxbox\maxbox3\examples\276_save_algo.txt$
11 *
12 * Created: 2012-02-09 by mX4
13 * Modified: $Date: 2012-05-14 2:40p $ @: Max
14 */**************************************************************}
</span><span class="pas1-number">15</span><span class="pas1-space"> 
</span><span class="pas1-number">16</span><span class="pas1-space"> 
</span><span class="pas1-number">17</span><span class="pas1-space"> </span><span class="pas1-reservedword">PROGRAM</span><span class="pas1-space"> Save_Algorithm;
</span><span class="pas1-number">18</span><span class="pas1-space"> </span><span class="pas1-reservedword">CONST</span><span class="pas1-space"> 
</span><span class="pas1-number">19</span><span class="pas1-space"> </span><span class="pas1-comment">//&lt;Constant declarations&gt; 
</span><span class="pas1-number">20</span><span class="pas1-space">   FILENAME = </span><span class="pas1-string">'savetestfile4.txt'</span><span class="pas1-symbol">;
</span><span class="pas1-number">21</span><span class="pas1-space"> 
</span><span class="pas1-number">22</span><span class="pas1-space"> </span><span class="pas1-comment">{TYPE 
23 &lt;Type declarations&gt;}</span><span class="pas1-space"> 
</span><span class="pas1-number">24</span><span class="pas1-space"> 
</span><span class="pas1-number">25</span><span class="pas1-space"> </span><span class="pas1-reservedword">Var</span><span class="pas1-space"> 
</span><span class="pas1-number">26</span><span class="pas1-space"> </span><span class="pas1-comment">//&lt;Variable declarations&gt;
</span><span class="pas1-number">27</span><span class="pas1-space">   i: integer;
</span><span class="pas1-number">28</span><span class="pas1-space">   FModif: boolean;
</span><span class="pas1-number">29</span><span class="pas1-space">   msd: TSaveDialog;
</span><span class="pas1-number">30</span><span class="pas1-space"> 
</span><span class="pas1-number">31</span><span class="pas1-space"> </span><span class="pas1-comment">//&lt;FUNCTION&gt;
</span><span class="pas1-number">32</span><span class="pas1-space"> </span><span class="pas1-comment">//&lt;PROCEDURE&gt; 
</span><span class="pas1-number">33</span><span class="pas1-space"> 
</span><span class="pas1-number">34</span><span class="pas1-space"> </span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> TEdit_SaveToFile(afilename: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">);
</span><span class="pas1-number">35</span><span class="pas1-space"> </span><span class="pas1-reservedword">begin
</span><span class="pas1-number">36</span><span class="pas1-space">   maxform1.Memo2.Lines.SaveToFile(aFileName);
</span><span class="pas1-number">37</span><span class="pas1-space">   FModif:= False;
</span><span class="pas1-number">38</span><span class="pas1-space">   msg(</span><span class="pas1-string">'writeln to (Save file): '</span><span class="pas1-symbol">+FILENAME);
</span><span class="pas1-number">39</span><span class="pas1-space"> </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;
</span><span class="pas1-number">40</span><span class="pas1-space"> 
</span><span class="pas1-number">41</span><span class="pas1-space"> 
</span><span class="pas1-number">42</span><span class="pas1-space"> </span><span class="pas1-reservedword">function</span><span class="pas1-space"> TEditForm_Save(ForceSave, changeName: Boolean): Boolean;   </span><span class="pas1-comment">//Original
</span><span class="pas1-number">43</span><span class="pas1-space"> </span><span class="pas1-reservedword">var</span><span class="pas1-space"> ffilename: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-number">44</span><span class="pas1-space">       funnamed: boolean;
</span><span class="pas1-number">45</span><span class="pas1-space"> </span><span class="pas1-reservedword">begin
</span><span class="pas1-number">46</span><span class="pas1-space">   </span><span class="pas1-comment">//ffilename:= Exepath+'savetestfile.txt';
</span><span class="pas1-number">47</span><span class="pas1-space">   </span><span class="pas1-reservedword">if</span><span class="pas1-space"> ffilename = </span><span class="pas1-string">''</span><span class="pas1-space"> </span><span class="pas1-reservedword">then</span><span class="pas1-space"> funnamed:= true;
</span><span class="pas1-number">48</span><span class="pas1-space">   Fmodif:= true;
</span><span class="pas1-number">49</span><span class="pas1-space">   Result:= False;
</span><span class="pas1-number">50</span><span class="pas1-space">   </span><span class="pas1-reservedword">if</span><span class="pas1-space"> </span><span class="pas1-reservedword">not</span><span class="pas1-space"> ForceSave </span><span class="pas1-reservedword">and</span><span class="pas1-space"> FModif </span><span class="pas1-reservedword">then
</span><span class="pas1-number">51</span><span class="pas1-space">     </span><span class="pas1-reservedword">case</span><span class="pas1-space"> MessageDlg(Format(</span><span class="pas1-string">'Save changes to %s?'</span><span class="pas1-symbol">,
</span><span class="pas1-number">52</span><span class="pas1-space">        [ExtractFileName(FFileName)]),mtConfirmation,[mbYes,mbNo,mbCancel],</span><span class="pas1-number">0</span><span class="pas1-symbol">) </span><span class="pas1-reservedword">of
</span><span class="pas1-number">53</span><span class="pas1-space">       mrYes: ForceSave:= True;
</span><span class="pas1-number">54</span><span class="pas1-space">       mrCancel: Exit;
</span><span class="pas1-number">55</span><span class="pas1-space">     </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;
</span><span class="pas1-number">56</span><span class="pas1-space">   </span><span class="pas1-reservedword">if</span><span class="pas1-space"> ForceSave </span><span class="pas1-reservedword">then</span><span class="pas1-space"> </span><span class="pas1-reservedword">begin
</span><span class="pas1-number">57</span><span class="pas1-space">     </span><span class="pas1-reservedword">if</span><span class="pas1-space"> ChangeName </span><span class="pas1-reservedword">or</span><span class="pas1-space"> FUnnamed </span><span class="pas1-reservedword">then
</span><span class="pas1-number">58</span><span class="pas1-space">      </span><span class="pas1-reservedword">if</span><span class="pas1-space"> </span><span class="pas1-reservedword">not</span><span class="pas1-space"> PromptForFileName(FFileName,</span><span class="pas1-string">'Media files(*.TXT)|*.txt'</span><span class="pas1-symbol">,
</span><span class="pas1-number">59</span><span class="pas1-space">                       </span><span class="pas1-string">'txt'</span><span class="pas1-symbol">, </span><span class="pas1-string">'Save mX3 file'</span><span class="pas1-symbol">, ExePath, true) </span><span class="pas1-comment">//false: Open dialog!
</span><span class="pas1-number">60</span><span class="pas1-space">      </span><span class="pas1-reservedword">then</span><span class="pas1-space"> Exit; 
</span><span class="pas1-number">61</span><span class="pas1-space">     </span><span class="pas1-comment">//SaveToFile;
</span><span class="pas1-number">62</span><span class="pas1-space">     TEdit_SaveToFile(ffilename)
</span><span class="pas1-number">63</span><span class="pas1-space">   </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;
</span><span class="pas1-number">64</span><span class="pas1-space">   Result:= True;
</span><span class="pas1-number">65</span><span class="pas1-space"> </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;
</span><span class="pas1-number">66</span><span class="pas1-space"> 
</span><span class="pas1-number">67</span><span class="pas1-space"> 
</span><span class="pas1-number">68</span><span class="pas1-space"> </span><span class="pas1-reservedword">function</span><span class="pas1-space"> TEditSave1(ForceSave: Boolean): Boolean;
</span><span class="pas1-number">69</span><span class="pas1-space"> </span><span class="pas1-reservedword">var</span><span class="pas1-space"> ffilename: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-number">70</span><span class="pas1-space">     funnamed: boolean;
</span><span class="pas1-number">71</span><span class="pas1-space"> </span><span class="pas1-reservedword">begin
</span><span class="pas1-number">72</span><span class="pas1-space">   </span><span class="pas1-comment">//ffilename:= Exepath+'savetestfile.txt';
</span><span class="pas1-number">73</span><span class="pas1-space">   </span><span class="pas1-reservedword">if</span><span class="pas1-space"> ffilename = </span><span class="pas1-string">''</span><span class="pas1-space"> </span><span class="pas1-reservedword">then</span><span class="pas1-space"> funnamed:= true;
</span><span class="pas1-number">74</span><span class="pas1-space">   fmodif:= true;
</span><span class="pas1-number">75</span><span class="pas1-space">   Result:= False;
</span><span class="pas1-number">76</span><span class="pas1-space">   </span><span class="pas1-reservedword">if</span><span class="pas1-space"> ForceSave </span><span class="pas1-reservedword">and</span><span class="pas1-space"> FModif </span><span class="pas1-reservedword">then
</span><span class="pas1-number">77</span><span class="pas1-space">     </span><span class="pas1-reservedword">case</span><span class="pas1-space"> MessageDlg(Format(</span><span class="pas1-string">'Save changes to %s?'</span><span class="pas1-symbol">,
</span><span class="pas1-number">78</span><span class="pas1-space">        [ExtractFileName(FFileName)]), mtConfirmation, [mbYes,mbNo,mbCancel], </span><span class="pas1-number">0</span><span class="pas1-symbol">)
</span><span class="pas1-number">79</span><span class="pas1-space">     </span><span class="pas1-reservedword">of
</span><span class="pas1-number">80</span><span class="pas1-space">       mrYes: </span><span class="pas1-reservedword">begin
</span><span class="pas1-number">81</span><span class="pas1-space">                ForceSave:= True;
</span><span class="pas1-number">82</span><span class="pas1-space">                fmodif:= false;
</span><span class="pas1-number">83</span><span class="pas1-space">              </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;  
</span><span class="pas1-number">84</span><span class="pas1-space">       mrCancel: Exit;
</span><span class="pas1-number">85</span><span class="pas1-space">     </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;
</span><span class="pas1-number">86</span><span class="pas1-space">   </span><span class="pas1-reservedword">if</span><span class="pas1-space"> </span><span class="pas1-reservedword">not</span><span class="pas1-space"> ForceSave </span><span class="pas1-reservedword">and</span><span class="pas1-space"> fModif </span><span class="pas1-reservedword">then</span><span class="pas1-space"> </span><span class="pas1-reservedword">begin
</span><span class="pas1-number">87</span><span class="pas1-space">     ForceSave:= True;
</span><span class="pas1-number">88</span><span class="pas1-space">     fModif:= false;
</span><span class="pas1-number">89</span><span class="pas1-space">   </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;
</span><span class="pas1-number">90</span><span class="pas1-space">   </span><span class="pas1-reservedword">if</span><span class="pas1-space"> ForceSave </span><span class="pas1-reservedword">and</span><span class="pas1-space"> </span><span class="pas1-reservedword">not</span><span class="pas1-space"> fModif </span><span class="pas1-reservedword">then</span><span class="pas1-space"> </span><span class="pas1-reservedword">begin
</span><span class="pas1-number">91</span><span class="pas1-space">     </span><span class="pas1-reservedword">if</span><span class="pas1-space"> FUnnamed </span><span class="pas1-reservedword">then
</span><span class="pas1-number">92</span><span class="pas1-space">      </span><span class="pas1-reservedword">if</span><span class="pas1-space"> </span><span class="pas1-reservedword">not</span><span class="pas1-space"> PromptForFileName(FFileName,</span><span class="pas1-string">'Media files(*.TXT)|*.txt'</span><span class="pas1-symbol">,
</span><span class="pas1-number">93</span><span class="pas1-space">                       </span><span class="pas1-string">'txt'</span><span class="pas1-symbol">, </span><span class="pas1-string">'Save mX3 file'</span><span class="pas1-symbol">, ExePath, true) </span><span class="pas1-comment">//false: Open dialog!
</span><span class="pas1-number">94</span><span class="pas1-space">      </span><span class="pas1-reservedword">then</span><span class="pas1-space"> Exit; 
</span><span class="pas1-number">95</span><span class="pas1-space">     </span><span class="pas1-comment">//SaveToFile;
</span><span class="pas1-number">96</span><span class="pas1-space">     TEdit_SaveToFile(ffilename)
</span><span class="pas1-number">97</span><span class="pas1-space">   </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;
</span><span class="pas1-number">98</span><span class="pas1-space">   </span><span class="pas1-comment">{if not ForceSave and fModified then begin
99     if FUnnamed then
100      if not PromptForFileName(FFileName,'Media files(*.TXT)|*.txt',
101                       'txt', 'Save mX3 file', ExePath, true) 
102      then Exit; 
103     //SaveToFile;
104     TEditForm_SaveToFile(ffilename)
105   end;}
</span><span class="pas1-number">106</span><span class="pas1-space">   Result:= True;
</span><span class="pas1-number">107</span><span class="pas1-space"> </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;
</span><span class="pas1-number">108</span><span class="pas1-space"> 
</span><span class="pas1-number">109</span><span class="pas1-space"> 
</span><span class="pas1-number">110</span><span class="pas1-space"> </span><span class="pas1-reservedword">function</span><span class="pas1-space"> TEditSave2(forceSave: Boolean): Boolean;
</span><span class="pas1-number">111</span><span class="pas1-space"> </span><span class="pas1-reservedword">var</span><span class="pas1-space"> fFilenm: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-number">112</span><span class="pas1-space">     funnamed: boolean;
</span><span class="pas1-number">113</span><span class="pas1-space"> </span><span class="pas1-reservedword">begin
</span><span class="pas1-number">114</span><span class="pas1-space">   fFilenm:= Exepath+FILENAME;
</span><span class="pas1-number">115</span><span class="pas1-space">   Result:= False;
</span><span class="pas1-number">116</span><span class="pas1-space">   </span><span class="pas1-comment">//if ffilenm = '' then funnamed:= true;
</span><span class="pas1-number">117</span><span class="pas1-space">   FModif:= true;
</span><span class="pas1-number">118</span><span class="pas1-space">   </span><span class="pas1-reservedword">if</span><span class="pas1-space"> </span><span class="pas1-reservedword">Not</span><span class="pas1-space"> forceSave </span><span class="pas1-reservedword">And</span><span class="pas1-space"> FModif </span><span class="pas1-reservedword">then</span><span class="pas1-space"> </span><span class="pas1-reservedword">begin
</span><span class="pas1-number">119</span><span class="pas1-space">     forceSave:= true;
</span><span class="pas1-number">120</span><span class="pas1-space">     FModif:= false;
</span><span class="pas1-number">121</span><span class="pas1-space">   </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;  
</span><span class="pas1-number">122</span><span class="pas1-space">   </span><span class="pas1-reservedword">if</span><span class="pas1-space"> forceSave </span><span class="pas1-reservedword">And</span><span class="pas1-space"> FModif </span><span class="pas1-reservedword">then
</span><span class="pas1-number">123</span><span class="pas1-space">     </span><span class="pas1-reservedword">Case</span><span class="pas1-space"> MessageDlg(Format(</span><span class="pas1-string">'Save change to %s?'</span><span class="pas1-symbol">, [ExtractFileName(fFilenm)])
</span><span class="pas1-number">124</span><span class="pas1-space">                       ,mtConfirmation,[mbYes,mbNo,mbCancel],</span><span class="pas1-number">0</span><span class="pas1-symbol">) </span><span class="pas1-reservedword">Of
</span><span class="pas1-number">125</span><span class="pas1-space">       </span><span class="pas1-comment">//mrYes: forceSave:= True;
</span><span class="pas1-number">126</span><span class="pas1-space">       mrNo: forceSave:= False;
</span><span class="pas1-number">127</span><span class="pas1-space">       mrCancel: Exit;
</span><span class="pas1-number">128</span><span class="pas1-space">     </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;
</span><span class="pas1-number">129</span><span class="pas1-space">   </span><span class="pas1-reservedword">if</span><span class="pas1-space"> forceSave </span><span class="pas1-reservedword">then</span><span class="pas1-space"> </span><span class="pas1-reservedword">begin
</span><span class="pas1-number">130</span><span class="pas1-space">     </span><span class="pas1-reservedword">if</span><span class="pas1-space"> funnamed </span><span class="pas1-reservedword">then
</span><span class="pas1-number">131</span><span class="pas1-space">       </span><span class="pas1-reservedword">if</span><span class="pas1-space"> </span><span class="pas1-reservedword">Not</span><span class="pas1-space"> PromptForFileName(fFilenm,</span><span class="pas1-string">'Mfiles(*.TXT)|*.txt'</span><span class="pas1-symbol">,
</span><span class="pas1-number">132</span><span class="pas1-space">                   </span><span class="pas1-string">'txt'</span><span class="pas1-symbol">,</span><span class="pas1-string">'Save mX3file'</span><span class="pas1-symbol">, ExePath,true) </span><span class="pas1-comment">//false=OpenDialog!
</span><span class="pas1-number">133</span><span class="pas1-space">       </span><span class="pas1-reservedword">then</span><span class="pas1-space"> Exit; 
</span><span class="pas1-number">134</span><span class="pas1-space">     TEdit_SaveToFile(fFilenm)
</span><span class="pas1-number">135</span><span class="pas1-space">   </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;
</span><span class="pas1-number">136</span><span class="pas1-space">   Result:= True;
</span><span class="pas1-number">137</span><span class="pas1-space"> </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;
</span><span class="pas1-number">138</span><span class="pas1-space"> 
</span><span class="pas1-number">139</span><span class="pas1-space"> 
</span><span class="pas1-number">140</span><span class="pas1-space"> </span><span class="pas1-reservedword">BEGIN</span><span class="pas1-space">  </span><span class="pas1-comment">//Main
</span><span class="pas1-number">141</span><span class="pas1-space"> </span><span class="pas1-comment">//&lt;Executable statements&gt;
</span><span class="pas1-number">142</span><span class="pas1-space"> </span><span class="pas1-comment">//if TEditSave1(false) then Msg('true') else Msg('false');
</span><span class="pas1-number">143</span><span class="pas1-space">   </span><span class="pas1-comment">// if TEditSave2(false) then Msg('true') else Msg('false');  //left strain
</span><span class="pas1-number">144</span><span class="pas1-space">   </span><span class="pas1-comment">// if TEditSave2(true) then Msg('true') else Msg('false');   //mid strain + unmodified
</span><span class="pas1-number">145</span><span class="pas1-space">      </span><span class="pas1-reservedword">if</span><span class="pas1-space"> TEditSave2(true) </span><span class="pas1-reservedword">then</span><span class="pas1-space"> Msg(</span><span class="pas1-string">'true'</span><span class="pas1-symbol">) </span><span class="pas1-reservedword">else</span><span class="pas1-space"> Msg(</span><span class="pas1-string">'false'</span><span class="pas1-symbol">);   </span><span class="pas1-comment">//right strain + modified
</span><span class="pas1-number">146</span><span class="pas1-space"> 
</span><span class="pas1-number">147</span><span class="pas1-space">   </span><span class="pas1-reservedword">for</span><span class="pas1-space"> i:= </span><span class="pas1-number">1</span><span class="pas1-space"> </span><span class="pas1-reservedword">to</span><span class="pas1-space"> </span><span class="pas1-number">3</span><span class="pas1-space"> </span><span class="pas1-reservedword">do</span><span class="pas1-space"> 
</span><span class="pas1-number">148</span><span class="pas1-space">     Writeln(FILENAME);
</span><span class="pas1-number">149</span><span class="pas1-space"> </span><span class="pas1-comment">//&lt;Definitions&gt;  
</span><span class="pas1-number">150</span><span class="pas1-space"> </span><span class="pas1-reservedword">END</span><span class="pas1-symbol">. 
</span><span class="pas1-number">151</span><span class="pas1-space"> 
</span><span class="pas1-number">152</span><span class="pas1-space"> ----app_template_loaded_code----
</span><span class="pas1-number">153</span><span class="pas1-space"> 
</span><span class="pas1-number">154</span><span class="pas1-space"> </span><span class="pas1-comment">//Which strain doesnt work in this alfo:
</span><span class="pas1-number">155</span><span class="pas1-space"> </span><span class="pas1-reservedword">function</span><span class="pas1-space"> TEditSave3(forceSave: Boolean): Boolean;
</span><span class="pas1-number">156</span><span class="pas1-space"> </span><span class="pas1-reservedword">var</span><span class="pas1-space"> fFilenm: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-number">157</span><span class="pas1-space">     funnamed, saveit: boolean;
</span><span class="pas1-number">158</span><span class="pas1-space"> </span><span class="pas1-reservedword">begin
</span><span class="pas1-number">159</span><span class="pas1-space">   fFilenm:= Exepath+FILENAME;
</span><span class="pas1-number">160</span><span class="pas1-space">   Result:= False;
</span><span class="pas1-number">161</span><span class="pas1-space">   </span><span class="pas1-comment">//if ffilenm = '' then funnamed:= true;
</span><span class="pas1-number">162</span><span class="pas1-space">   FModif:= false;
</span><span class="pas1-number">163</span><span class="pas1-space">   </span><span class="pas1-reservedword">if</span><span class="pas1-space"> </span><span class="pas1-reservedword">Not</span><span class="pas1-space"> forceSave </span><span class="pas1-reservedword">And</span><span class="pas1-space"> FModif </span><span class="pas1-reservedword">then
</span><span class="pas1-number">164</span><span class="pas1-space">     saveit:= true;
</span><span class="pas1-number">165</span><span class="pas1-space">   </span><span class="pas1-reservedword">if</span><span class="pas1-space"> forceSave </span><span class="pas1-reservedword">And</span><span class="pas1-space"> FModif </span><span class="pas1-reservedword">then
</span><span class="pas1-number">166</span><span class="pas1-space">     </span><span class="pas1-reservedword">Case</span><span class="pas1-space"> MessageDlg(Format(</span><span class="pas1-string">'Save changes to %s?'</span><span class="pas1-symbol">,
</span><span class="pas1-number">167</span><span class="pas1-space">         [ExtractFileName(fFilenm)]),mtConfirmation,[mbYes,mbNo,mbCancel],</span><span class="pas1-number">0</span><span class="pas1-symbol">) </span><span class="pas1-reservedword">Of
</span><span class="pas1-number">168</span><span class="pas1-space">       mrYes: saveit:= True;
</span><span class="pas1-number">169</span><span class="pas1-space">       mrNo: saveit:= False;
</span><span class="pas1-number">170</span><span class="pas1-space">       mrCancel: Exit;
</span><span class="pas1-number">171</span><span class="pas1-space">     </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;
</span><span class="pas1-number">172</span><span class="pas1-space">   </span><span class="pas1-reservedword">if</span><span class="pas1-space"> saveit </span><span class="pas1-reservedword">then</span><span class="pas1-space"> </span><span class="pas1-reservedword">begin
</span><span class="pas1-number">173</span><span class="pas1-space">     </span><span class="pas1-reservedword">if</span><span class="pas1-space"> FUnnamed </span><span class="pas1-reservedword">then
</span><span class="pas1-number">174</span><span class="pas1-space">       </span><span class="pas1-reservedword">if</span><span class="pas1-space"> </span><span class="pas1-reservedword">Not</span><span class="pas1-space"> PromptForFileName(fFilenm,</span><span class="pas1-string">'Mfiles(*.Txt)|*.txt'</span><span class="pas1-symbol">,
</span><span class="pas1-number">175</span><span class="pas1-space">                   </span><span class="pas1-string">'txt'</span><span class="pas1-symbol">, </span><span class="pas1-string">'Save mX3file'</span><span class="pas1-symbol">, ExePath, true) </span><span class="pas1-comment">//false: OpenDialog!
</span><span class="pas1-number">176</span><span class="pas1-space">       </span><span class="pas1-reservedword">then</span><span class="pas1-space"> Exit; 
</span><span class="pas1-number">177</span><span class="pas1-space">     TEdit_SaveToFile(fFilenm)
</span><span class="pas1-number">178</span><span class="pas1-space">   </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;
</span><span class="pas1-number">179</span><span class="pas1-space">   Result:= True;
</span><span class="pas1-number">180</span><span class="pas1-space"> </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;
</span><span class="pas1-number">181</span><span class="pas1-space"> 
</span></code></pre><!--EndFragment--></body>
</html>